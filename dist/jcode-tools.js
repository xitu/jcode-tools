(()=>{var R=Object.defineProperty;var I=(o,e)=>{for(var n in e)R(o,n,{get:e[n],enumerable:!0})};var j={};I(j,{CodeXClient:()=>b,Storage:()=>w,getCustomCode:()=>x,getURL:()=>X,logger:()=>T});var x=async()=>{let o;do{if(o=document.querySelector("body>script:last-of-type"),o&&/^text\/.*/.test(o.type))return o.textContent;await new Promise(e=>setTimeout(e,50))}while(1)};function J(o){return new Promise((e,n)=>{try{let r=new WebSocket(o);r.addEventListener("message",c=>{let s=JSON.parse(c.data);s.type==="init"&&(r.clientID=s.message),e(r)})}catch(r){n(r.message)}})}function _(){let o,e,n=new Promise((r,c)=>{o=r,e=c});return{resolve:o,reject:e,promise:n}}var H="https://codex.juejin.fun",A="wss://ws.juejin.fun",O={kotlin:"kt",node:"js",perl:"pl",python:"py",golang:"go",ruby:"rb",rust:"rs",csharp:"cs",erlang:"erl"},b=class{constructor(e=H,n=A){this.url=e,this.wsURL=n,this.socket=null,this.onmessage=null,this.onerror=null,this.socketReady=_()}async input(e){await this.socketReady.promise,this.socket.send(JSON.stringify({type:"stdin",message:e}))}async runCode({code:e,language:n,input:r,timeout:c=8}={}){e||(e=await x()),n==null&&(n=document.querySelector("body>script:last-of-type").type.split("/")[1]),O[n]&&(n=O[n]);let s={code:e,language:n,input:r,timeout:c},u={method:"POST",headers:{"Content-Type":"application/json"}};try{return this.socket||(this.socket=await J(this.wsURL),this.socket.addEventListener("message",t=>{let l=JSON.parse(t.data);l.type==="ready"?this.socketReady.resolve():l.type==="stdout"?this.onmessage&&this.onmessage(l.message):l.type==="stderr"&&this.onerror&&this.onerror(l.message)})),this.socket&&(s.wsID=this.socket.clientID),u.body=JSON.stringify(s),await(await fetch(this.url,u)).json()}catch(f){this.socket&&this.socket.close(),this.socket=null,console.error(f)}}};typeof BigInt=="function"&&!BigInt.prototype.toJSON&&(BigInt.prototype.toJSON=function(){return`${this}n`});function k(o,e,n,r){o[e]=o[e]||[],o[e][r]=n}function U(o){let e={};if(o){let n=0,r=Object.keys(o).every(c=>c===Number(c).toString());for(let[c,s]of Object.entries(o))if(typeof s!="function"){if(k(e,"(index)",r?Number(c):c,n),s==null||typeof s!="object"||s instanceof RegExp)k(e,"Value",s,n);else for(let[u,f]of Object.entries(s))k(e,u,f,n);n++}return e}return o}function P(o,e){let n=o["(index)"].length;if(n){let r=document.createElement("table"),c=document.createElement("thead");r.appendChild(c),r.className="jcode-logger__table";let s=Object.keys(o);e&&(s=s.filter(i=>i==="(index)"||i==="Value"||e.includes(i)));let u=document.createElement("tr");u.innerHTML=s.map((i,t)=>`<th data-index="${t}">${i}</th>`).join(""),c.appendChild(u);let f=document.createElement("tbody");r.appendChild(f);for(let i=0;i<n;i++){let t=document.createElement("tr");f.appendChild(t);for(let l=0;l<s.length;l++){let a=s[l],d=document.createElement("td");if(i in o[a]){let p=o[a][i];typeof p=="string"&&a!=="(index)"&&(p=`'${p}'`),Array.isArray(p)?p.length>3&&(d.textContent=`${p.slice(0,3)}... (total: ${p.length})`):typeof p=="bigint"?d.textContent=`${p}n`:typeof p=="symbol"?d.textContent=p.toString():d.textContent=p,d.className=L(p).toLowerCase()}t.appendChild(d)}}return r}}function E(o){return Object.prototype.toString.call(o)==="[object Object]"?JSON.stringify(o):o}function v(o){let e=E(o[0]),n=[],r=/%[cdfios]/,c=0;for(let s=1;s<o.length;s++){let u=E(o[s]);if(r.test(e))e=e.replace(r,f=>{if(f==="%c"){let i=`${c?"</span>":""}<span style="${u}">`;return c++,i}if(f==="%d"||f==="%i")return parseInt(u,10);if(f==="%f")return parseFloat(u);if(f==="%s")return u.toString();if(f==="%o")return JSON.stringify(u)});else{n.push(...o.slice(s).map(E));break}}return n=[e,...n],c&&n.push("</span>"),n}function L(o){return Object.prototype.toString.call(o).slice(8,-1)}function M(o,e=0){let n=document.createElement("ul");n.className="jcode-logger__dir";let r=L(o),c=document.createElement("div");c.textContent=o instanceof HTMLElement?o.tagName.toLowerCase():r,c.addEventListener("click",()=>{c.classList.toggle("expand")}),n.appendChild(c);let s=[];for(let u in o)typeof o[u]!="function"&&s.push([u,o[u]]);Array.isArray(o)&&s.push(["length",o.length]),s.sort((u,f)=>u[0]>f[0]?1:u[0]<f[0]?-1:0);for(let u=0;u<s.length;u++){let[f,i]=s[u];typeof i=="string"&&(i=`"${i}"`);let t=document.createElement("li"),l=document.createElement("em");l.textContent=f;let a=document.createElement("span");if(a.className=L(i).toLowerCase(),Array.isArray(i)&&i.length<=0?a.textContent="Array(0)":i instanceof NodeList?a.textContent=`NodeList(${i.length})`:i instanceof HTMLCollection?a.textContent=`HTMLCollection(${i.length})`:i instanceof DOMTokenList?a.textContent=`DOMTokenList(${i.length})`:i instanceof HTMLElement?a.textContent=`${i.tagName.toLowerCase()}${i.id?`#${i.id}`:""}`:a.textContent=i,e<2&&i&&typeof i=="object"&&!(i instanceof Window)){let d=M(i,e+1);d.children[0].innerHTML="",d.children[0].appendChild(l),d.children[0].appendChild(a),t.appendChild(d)}else t.appendChild(l),t.appendChild(a);n.appendChild(t)}return n}var B={log:console.log,info:console.info,warn:console.warn,error:console.error,dir:console.dir,table:console.table,group:console.group,groupCollapsed:console.groupCollapsed,groupEnd:console.groupEnd,count:console.count,countReset:console.countReset,time:console.time,timeEnd:console.timeEnd,assert:console.assert,clear:console.clear},T=(o,e=B)=>{let n=document.createElement("div");n.className="jcode-logger",o.append(n);let r=(t,l="info")=>{let a=document.createElement("pre");a.className=`jcode-logger__${l}`,a.innerHTML=t,n.appendChild(a)},c=t=>(...l)=>{e&&e[t](...l),l=v(l);let a=l.map(d=>d==null?String(d):d.toString?d.toString():Object.prototype.toString.call(d)).join(" ");r(a,t)},s=[],u=(t,l=!1)=>{let a=document.createElement("div");a.className="jcode-logger__group",n.appendChild(a);let d=document.createElement("div");d.textContent=t,l||(d.className="expand"),a.appendChild(d),d.addEventListener("click",()=>{d.classList.toggle("expand")}),s.push(n),n=a},f={},i={};return{log:c("log"),info:c("info"),warn:c("warn"),error:c("error"),assert:(t,...l)=>{if(e&&e.assert(t,...l),!t){let a=v(l).join(" ");r(`Assertion failed: ${a}`,"error")}},clear:()=>{e&&e.clear(),s.length>0&&(n=s[0],s.length=0),n.innerHTML=""},group:t=>{e&&e.group(t),u(t)},groupCollapsed:t=>{e&&e.groupCollapsed(t),u(t,!0)},groupEnd:()=>{e&&e.groupEnd(),s.length>0&&(n=s.pop())},count:(t="default")=>{e&&e.count(t),t=t.toString(),f[t]=f[t]||0,f[t]++,r(`${t}: ${f[t]}`)},time:(t="default")=>{e&&e.time(t),t=t.toString(),t in i?r(`Timer '${t}' already exists`,"warn"):i[t]=performance.now()},countReset:(t="default")=>{e&&e.countReset(t),t=t.toString(),t in f?delete f[t]:r(`Count for '${t}' does not exist`,"warn")},timeEnd:(t="default")=>{e&&e.timeEnd(t),t=t.toString(),t in i?(r(`${t}: ${performance.now()-i[t]} ms`),delete i[t]):r(`Timer '${t}' does not exist`,"warn")},dir:t=>{e&&e.dir(t);let l=M(t);n.appendChild(l)},table:(t,l)=>{e&&e.table(t,l);let a=U(t),d=P(a,l);d.addEventListener("click",p=>{let h=p.target;if(h.tagName==="TH"){let $=Number(h.dataset.index),S=[...d.querySelectorAll("tr")].slice(1);S.sort((m,C)=>{m=m.children[$],C=C.children[$];let g=m.textContent,y=C.textContent;return m.className==="number"&&(g=Number(g)),C.className==="number"&&(y=Number(y)),m.className==="bigint"&&(g=BigInt(g.slice(0,-1))),C.className==="bigint"&&(y=BigInt(y.slice(0,-1))),g>y?h.dataset.sort==="asc"?-1:1:g<y?h.dataset.sort==="asc"?1:-1:0}),S.forEach(m=>{d.appendChild(m)}),h.dataset.sort=h.dataset.sort==="asc"?"desc":"asc"}}),n.appendChild(d)}}};function D(o,e=13977641){let n=3735928559^e,r=1103547991^e;for(let c=0,s;c<o.length;c++)s=o.charCodeAt(c),n=Math.imul(n^s,2654435761),r=Math.imul(r^s,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}var N="https://kv.juejin.fun",w=class{constructor(e=D(location.href)){this.bucket=e}async get(e){let r=await(await fetch(`${N}/doc/${e}`,{method:"GET",headers:{"X-Project-Id":this.bucket}})).json();return this.result=r,r.error?null:r.result.value}async set(e,n){let c=await(await fetch(`${N}/doc/append/${e}`,{method:"POST",headers:{"X-Project-Id":this.bucket},body:JSON.stringify({value:n})})).json();return this.result=c,!c.error}async del(e){let r=await(await fetch(`${N}/doc/${e}`,{method:"DELETE",headers:{"X-Project-Id":this.bucket}})).json();return this.result=r,!r.error}};function W(o){let e=new Blob([o],{type:"text/javascript"});return URL.createObjectURL(e)}var X=async()=>{let o=await x();return W(o)};window.JCode=window.JCode||j;})();
