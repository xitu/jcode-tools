var JCode=(()=>{var k=Object.defineProperty;var R=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var H=(o,e)=>{for(var n in e)k(o,n,{get:e[n],enumerable:!0})},A=(o,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of I(e))!_.call(o,s)&&s!==n&&k(o,s,{get:()=>e[s],enumerable:!(r=R(e,s))||r.enumerable});return o};var U=o=>A(k({},"__esModule",{value:!0}),o);var K={};H(K,{CodeXClient:()=>b,Storage:()=>w,getCustomCode:()=>x,getURL:()=>G,logger:()=>T});var x=async()=>{let o;do{if(o=document.querySelector("body>script:last-of-type"),o&&/^text\/.*/.test(o.type))return o.textContent;await new Promise(e=>setTimeout(e,50))}while(1)};function J(o){return new Promise((e,n)=>{try{let r=new WebSocket(o);r.addEventListener("message",s=>{let c=JSON.parse(s.data);c.type==="init"&&(r.clientID=c.message),e(r)})}catch(r){n(r.message)}})}function P(){let o,e,n=new Promise((r,s)=>{o=r,e=s});return{resolve:o,reject:e,promise:n}}var B="https://codex.juejin.fun",D="wss://ws.juejin.fun",O={kotlin:"kt",node:"js",perl:"pl",python:"py",golang:"go",ruby:"rb",rust:"rs",csharp:"cs",erlang:"erl"},b=class{constructor(e=B,n=D){this.url=e,this.wsURL=n,this.socket=null,this.onmessage=null,this.onerror=null,this.socketReady=P()}async input(e){await this.socketReady.promise,this.socket.send(JSON.stringify({type:"stdin",message:e}))}async runCode({code:e,language:n,input:r,timeout:s=8}={}){e||(e=await x()),n==null&&(n=document.querySelector("body>script:last-of-type").type.split("/")[1]),O[n]&&(n=O[n]);let c={code:e,language:n,input:r,timeout:s},a={method:"POST",headers:{"Content-Type":"application/json"}};try{return this.socket||(this.socket=await J(this.wsURL),this.socket.addEventListener("message",t=>{let l=JSON.parse(t.data);l.type==="ready"?this.socketReady.resolve():l.type==="stdout"?this.onmessage&&this.onmessage(l.message):l.type==="stderr"&&this.onerror&&this.onerror(l.message)})),this.socket&&(c.wsID=this.socket.clientID),a.body=JSON.stringify(c),await(await fetch(this.url,a)).json()}catch(f){this.socket&&this.socket.close(),this.socket=null,console.error(f)}}};typeof BigInt=="function"&&!BigInt.prototype.toJSON&&(BigInt.prototype.toJSON=function(){return`${this}n`});function E(o,e,n,r){o[e]=o[e]||[],o[e][r]=n}function W(o){let e={};if(o){let n=0,r=Object.keys(o).every(s=>s===Number(s).toString());for(let[s,c]of Object.entries(o))if(typeof c!="function"){if(E(e,"(index)",r?Number(s):s,n),c==null||typeof c!="object"||c instanceof RegExp)E(e,"Value",c,n);else for(let[a,f]of Object.entries(c))E(e,a,f,n);n++}return e}return o}function X(o,e){let n=o["(index)"].length;if(n){let r=document.createElement("table"),s=document.createElement("thead");r.appendChild(s),r.className="jcode-logger__table";let c=Object.keys(o);e&&(c=c.filter(i=>i==="(index)"||i==="Value"||e.includes(i)));let a=document.createElement("tr");a.innerHTML=c.map((i,t)=>`<th data-index="${t}">${i}</th>`).join(""),s.appendChild(a);let f=document.createElement("tbody");r.appendChild(f);for(let i=0;i<n;i++){let t=document.createElement("tr");f.appendChild(t);for(let l=0;l<c.length;l++){let d=c[l],u=document.createElement("td");if(i in o[d]){let p=o[d][i];typeof p=="string"&&d!=="(index)"&&(p=`'${p}'`),Array.isArray(p)?p.length>3&&(u.textContent=`${p.slice(0,3)}... (total: ${p.length})`):typeof p=="bigint"?u.textContent=`${p}n`:typeof p=="symbol"?u.textContent=p.toString():u.textContent=p,u.className=N(p).toLowerCase()}t.appendChild(u)}}return r}}function L(o){if(Object.prototype.toString.call(o)==="[object Object]")try{return JSON.stringify(o)}catch{return o.toString()}return o}function v(o){let e=L(o[0]),n=[],r=/%[cdfios]/,s=0;for(let c=1;c<o.length;c++){let a=L(o[c]);if(r.test(e))e=e.replace(r,f=>{if(f==="%c"){let i=`${s?"</span>":""}<span style="${a}">`;return s++,i}if(f==="%d"||f==="%i")return parseInt(a,10);if(f==="%f")return parseFloat(a);if(f==="%s")return a.toString();if(f==="%o")try{return JSON.stringify(a)}catch{return a.toString()}});else{n.push(...o.slice(c).map(L));break}}return n=[e,...n],s&&n.push("</span>"),n}function N(o){return Object.prototype.toString.call(o).slice(8,-1)}function M(o,e=0){let n=document.createElement("ul");n.className="jcode-logger__dir";let r=N(o),s=document.createElement("div");s.textContent=o instanceof HTMLElement?o.tagName.toLowerCase():r,s.addEventListener("click",()=>{s.classList.toggle("expand")}),n.appendChild(s);let c=[];for(let a in o)typeof o[a]!="function"&&c.push([a,o[a]]);Array.isArray(o)&&c.push(["length",o.length]),c.sort((a,f)=>a[0]>f[0]?1:a[0]<f[0]?-1:0);for(let a=0;a<c.length;a++){let[f,i]=c[a];typeof i=="string"&&(i=`"${i}"`);let t=document.createElement("li"),l=document.createElement("em");l.textContent=f;let d=document.createElement("span");if(d.className=N(i).toLowerCase(),Array.isArray(i)&&i.length<=0?d.textContent="Array(0)":i instanceof NodeList?d.textContent=`NodeList(${i.length})`:i instanceof HTMLCollection?d.textContent=`HTMLCollection(${i.length})`:i instanceof DOMTokenList?d.textContent=`DOMTokenList(${i.length})`:i instanceof HTMLElement?d.textContent=`${i.tagName.toLowerCase()}${i.id?`#${i.id}`:""}`:d.textContent=i,e<2&&i&&typeof i=="object"&&!(i instanceof Window)){let u=M(i,e+1);u.children[0].innerHTML="",u.children[0].appendChild(l),u.children[0].appendChild(d),t.appendChild(u)}else t.appendChild(l),t.appendChild(d);n.appendChild(t)}return n}var q={log:console.log,info:console.info,warn:console.warn,error:console.error,dir:console.dir,table:console.table,group:console.group,groupCollapsed:console.groupCollapsed,groupEnd:console.groupEnd,count:console.count,countReset:console.countReset,time:console.time,timeEnd:console.timeEnd,assert:console.assert,clear:console.clear},T=(o,e=q)=>{let n=document.createElement("div");n.className="jcode-logger",o.append(n);let r=(t,l="info")=>{let d=document.createElement("pre");d.className=`jcode-logger__${l}`,d.innerHTML=t,n.appendChild(d)},s=t=>(...l)=>{e&&e[t](...l),l=v(l);let d=l.map(u=>u==null?String(u):u.toString?u.toString():Object.prototype.toString.call(u)).join(" ");r(d,t)},c=[],a=(t,l=!1)=>{let d=document.createElement("div");d.className="jcode-logger__group",n.appendChild(d);let u=document.createElement("div");u.textContent=t,l||(u.className="expand"),d.appendChild(u),u.addEventListener("click",()=>{u.classList.toggle("expand")}),c.push(n),n=d},f={},i={};return{log:s("log"),info:s("info"),warn:s("warn"),error:s("error"),assert:(t,...l)=>{if(e&&e.assert(t,...l),!t){let d=v(l).join(" ");r(`Assertion failed: ${d}`,"error")}},clear:()=>{e&&e.clear(),c.length>0&&(n=c[0],c.length=0),n.innerHTML=""},group:t=>{e&&e.group(t),a(t)},groupCollapsed:t=>{e&&e.groupCollapsed(t),a(t,!0)},groupEnd:()=>{e&&e.groupEnd(),c.length>0&&(n=c.pop())},count:(t="default")=>{e&&e.count(t),t=t.toString(),f[t]=f[t]||0,f[t]++,r(`${t}: ${f[t]}`)},time:(t="default")=>{e&&e.time(t),t=t.toString(),t in i?r(`Timer '${t}' already exists`,"warn"):i[t]=performance.now()},countReset:(t="default")=>{e&&e.countReset(t),t=t.toString(),t in f?delete f[t]:r(`Count for '${t}' does not exist`,"warn")},timeEnd:(t="default")=>{e&&e.timeEnd(t),t=t.toString(),t in i?(r(`${t}: ${performance.now()-i[t]} ms`),delete i[t]):r(`Timer '${t}' does not exist`,"warn")},dir:t=>{e&&e.dir(t);let l=M(t);n.appendChild(l)},table:(t,l)=>{e&&e.table(t,l);let d=W(t),u=X(d,l);u.addEventListener("click",p=>{let m=p.target;if(m.tagName==="TH"){let j=Number(m.dataset.index),$=[...u.querySelectorAll("tr")].slice(1);$.sort((h,C)=>{h=h.children[j],C=C.children[j];let g=h.textContent,y=C.textContent;return h.className==="number"&&(g=Number(g)),C.className==="number"&&(y=Number(y)),h.className==="bigint"&&(g=BigInt(g.slice(0,-1))),C.className==="bigint"&&(y=BigInt(y.slice(0,-1))),g>y?m.dataset.sort==="asc"?-1:1:g<y?m.dataset.sort==="asc"?1:-1:0}),$.forEach(h=>{u.appendChild(h)}),m.dataset.sort=m.dataset.sort==="asc"?"desc":"asc"}}),n.appendChild(u)}}};function V(o,e=13977641){let n=3735928559^e,r=1103547991^e;for(let s=0,c;s<o.length;s++)c=o.charCodeAt(s),n=Math.imul(n^c,2654435761),r=Math.imul(r^c,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}var S="https://kv.juejin.fun",w=class{constructor(e=V(location.href)){this.bucket=e}async get(e){let r=await(await fetch(`${S}/doc/${e}`,{method:"GET",headers:{"X-Project-Id":this.bucket}})).json();return this.result=r,r.error?null:r.result.value}async set(e,n){let s=await(await fetch(`${S}/doc/append/${e}`,{method:"POST",headers:{"X-Project-Id":this.bucket},body:JSON.stringify({value:n})})).json();return this.result=s,!s.error}async del(e){let r=await(await fetch(`${S}/doc/${e}`,{method:"DELETE",headers:{"X-Project-Id":this.bucket}})).json();return this.result=r,!r.error}};function F(o){let e=new Blob([o],{type:"text/javascript"});return URL.createObjectURL(e)}var G=async()=>{let o=await x();return F(o)};return U(K);})();
